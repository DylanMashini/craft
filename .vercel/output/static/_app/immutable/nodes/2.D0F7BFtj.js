import{r as Be,s as Me,n as Ee,b as Ne,x as Xe,i as Te,e as fe}from"../chunks/scheduler.u2sAWruA.js";import{t as Pe,S as Ve,i as He,e as V,s as O,c as H,l as W,d as N,a as z,z as Ue,b as X,g as ve,f as Y,A as We,k as ee,m as te,B as me,n as ne}from"../chunks/index.cogxvB92.js";import{w as qe}from"../chunks/index.Ddwg8BFW.js";function Z(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function Oe(t,o){t.d(1),o.delete(t.key)}function ze(t,o,n,s,u,v,e,b,E,S,m,p){let _=t.length,g=v.length,h=_;const l={};for(;h--;)l[t[h].key]=h;const i=[],r=new Map,a=new Map,d=[];for(h=g;h--;){const y=p(u,v,h),w=n(y);let k=e.get(w);k?d.push(()=>k.p(y,o)):(k=S(w,y),k.c()),r.set(w,i[h]=k),w in l&&a.set(w,Math.abs(h-l[w]))}const f=new Set,A=new Set;function D(y){Pe(y,1),y.m(b,m),e.set(y.key,y),m=y.first,g--}for(;_&&g;){const y=i[g-1],w=t[_-1],k=y.key,B=w.key;y===w?(m=y.first,_--,g--):r.has(B)?!e.has(k)||f.has(k)?D(y):A.has(B)?_--:a.get(k)>a.get(B)?(A.add(k),D(y)):(f.add(B),_--):(E(w,e),_--)}for(;_--;){const y=t[_];r.has(y.key)||E(y,e)}for(;g;)D(i[g-1]);return Be(d),i}var ue={dragStart:!0},De=(t,o,n)=>Math.min(Math.max(t,o),n),he=t=>typeof t=="string",Je=([t,o],n,s)=>{const u=(v,e)=>e===0?0:Math.ceil(v/e)*e;return[u(n,t),u(s,o)]},Ie=(t,o)=>t.some(n=>o.some(s=>n.contains(s)));function ge(t,o){if(t===void 0)return;if(pe(t))return t.getBoundingClientRect();if(typeof t=="object"){const{top:s=0,left:u=0,right:v=0,bottom:e=0}=t;return{top:s,right:window.innerWidth-v,bottom:window.innerHeight-e,left:u}}if(t==="parent")return o.parentNode.getBoundingClientRect();const n=document.querySelector(t);if(n===null)throw new Error("The selector provided for bound doesn't exists in the document.");return n.getBoundingClientRect()}var $=(t,o,n)=>t.style.setProperty(o,n),pe=t=>t instanceof HTMLElement,Fe=(t,o={})=>{let n,s,{bounds:u,axis:v="both",gpuAcceleration:e=!0,legacyTranslate:b=!0,transform:E,applyUserSelectHack:S=!0,disabled:m=!1,ignoreMultitouch:p=!1,recomputeBounds:_=ue,grid:g,position:h,cancel:l,handle:i,defaultClass:r="neodrag",defaultClassDragging:a="neodrag-dragging",defaultClassDragged:d="neodrag-dragged",defaultPosition:f={x:0,y:0},onDragStart:A,onDrag:D,onDragEnd:y}=o,w=!1,k=0,B=0,J=0,F=0,ie=0,le=0,{x:G,y:K}=h?{x:(h==null?void 0:h.x)??0,y:(h==null?void 0:h.y)??0}:f;ae(G,K);let T,q,x,se,_e,we="",Le=!!h;_={...ue,..._};let Q=new Set;const re=document.body.style,U=t.classList;function ae(c=k,I=B){if(!E){if(b){let j=`${+c}px, ${+I}px`;return $(t,"transform",e?`translate3d(${j}, 0)`:`translate(${j})`)}return $(t,"translate",`${+c}px ${+I}px ${e?"1px":""}`)}const R=E({offsetX:c,offsetY:I,rootNode:t});he(R)&&$(t,"transform",R)}const de=(c,I)=>{const R={offsetX:k,offsetY:B,rootNode:t,currentNode:_e};t.dispatchEvent(new CustomEvent(c,{detail:R})),I==null||I(R)},ce=addEventListener;ce("pointerdown",ye,!1),ce("pointerup",Se,!1),ce("pointermove",Ce,!1),$(t,"touch-action","none");const be=()=>{let c=t.offsetWidth/q.width;return isNaN(c)&&(c=1),c};function ye(c){if(m||c.button===2)return;if(Q.add(c.pointerId),p&&Q.size>1)return c.preventDefault();if(_.dragStart&&(T=ge(u,t)),he(i)&&he(l)&&i===l)throw new Error("`handle` selector can't be same as `cancel` selector");if(U.add(r),x=function(C,M){if(!C)return[M];if(pe(C))return[C];if(Array.isArray(C))return C;const P=M.querySelectorAll(C);if(P===null)throw new Error("Selector passed for `handle` option should be child of the element on which the action is applied");return Array.from(P.values())}(i,t),se=function(C,M){if(!C)return[];if(pe(C))return[C];if(Array.isArray(C))return C;const P=M.querySelectorAll(C);if(P===null)throw new Error("Selector passed for `cancel` option should be child of the element on which the action is applied");return Array.from(P.values())}(l,t),n=/(both|x)/.test(v),s=/(both|y)/.test(v),Ie(se,x))throw new Error("Element being dragged can't be a child of the element on which `cancel` is applied");const I=c.composedPath()[0];if(!x.some(C=>{var M;return C.contains(I)||((M=C.shadowRoot)==null?void 0:M.contains(I))})||Ie(se,[I]))return;_e=x.length===1?t:x.find(C=>C.contains(I)),w=!0,q=t.getBoundingClientRect(),S&&(we=re.userSelect,re.userSelect="none"),de("neodrag:start",A);const{clientX:R,clientY:j}=c,L=be();n&&(J=R-G/L),s&&(F=j-K/L),T&&(ie=R-q.left,le=j-q.top)}function Se(c){Q.delete(c.pointerId),w&&(_.dragEnd&&(T=ge(u,t)),U.remove(a),U.add(d),S&&(re.userSelect=we),de("neodrag:end",y),n&&(J=k),s&&(F=B),w=!1)}function Ce(c){if(!w||p&&Q.size>1)return;_.drag&&(T=ge(u,t)),U.add(a),c.preventDefault(),q=t.getBoundingClientRect();let I=c.clientX,R=c.clientY;const j=be();if(T){const L={left:T.left+ie,top:T.top+le,right:T.right+ie-q.width,bottom:T.bottom+le-q.height};I=De(I,L.left,L.right),R=De(R,L.top,L.bottom)}if(Array.isArray(g)){let[L,C]=g;if(isNaN(+L)||L<0)throw new Error("1st argument of `grid` must be a valid positive number");if(isNaN(+C)||C<0)throw new Error("2nd argument of `grid` must be a valid positive number");let M=I-J,P=R-F;[M,P]=Je([L/j,C/j],M,P),I=J+M,R=F+P}n&&(k=Math.round((I-J)*j)),s&&(B=Math.round((R-F)*j)),G=k,K=B,de("neodrag",D),ae()}return{destroy:()=>{const c=removeEventListener;c("pointerdown",ye,!1),c("pointerup",Se,!1),c("pointermove",Ce,!1)},update:c=>{var R,j;v=c.axis||"both",m=c.disabled??!1,p=c.ignoreMultitouch??!1,i=c.handle,u=c.bounds,_=c.recomputeBounds??ue,l=c.cancel,S=c.applyUserSelectHack??!0,g=c.grid,e=c.gpuAcceleration??!0,b=c.legacyTranslate??!0,E=c.transform;const I=U.contains(d);U.remove(r,d),r=c.defaultClass??"neodrag",a=c.defaultClassDragging??"neodrag-dragging",d=c.defaultClassDragged??"neodrag-dragged",U.add(r),I&&U.add(d),Le&&(G=k=((R=c.position)==null?void 0:R.x)??k,K=B=((j=c.position)==null?void 0:j.y)??B,ae())}}};let xe=[{emoji:"ðŸ’§",name:"Water"},{emoji:"ðŸ”¥",name:"Fire"},{emoji:"ðŸŒŽ",name:"Earth"},{emoji:"ðŸ’¨",name:"Wind"}],oe=qe(xe);if(typeof window<"u"){let t=localStorage.getItem("unlockedRecipes");t&&oe.set(JSON.parse(t)),oe.subscribe(o=>{localStorage.setItem("unlockedRecipes",JSON.stringify(o))})}const Ge="http://localhost:4173";function ke(t,o){const n=t.getBoundingClientRect(),s=o.getBoundingClientRect();return!(n.right<s.left||n.left>s.right||n.bottom<s.top||n.top>s.bottom)}async function Ke(t,o){let n=await(await fetch(Ge+"/api/createNewItem",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({item1:t,item2:o})})).json();return oe.update(s=>(typeof s.find(u=>u.name===n.name)>"u"&&s.push(n),s)),n}function Ae(t,o,n){const s=t.slice();return s[12]=o[n],s}function Re(t,o,n){const s=t.slice();return s[15]=o[n],s[16]=o,s[17]=n,s}function Ye(t,o){let n,s=o[15].emoji+"",u,v,e=o[15].name+"",b,E,S=o[16],m=o[17],p,_,g;const h=()=>o[7](n,S,m),l=()=>o[7](null,S,m);return{key:t,first:null,c(){n=V("div"),u=ee(s),v=O(),b=ee(e),this.h()},l(i){n=H(i,"DIV",{class:!0});var r=W(n);u=te(r,s),v=z(r),b=te(r,e),r.forEach(N),this.h()},h(){X(n,"class",E="item absolute "+(o[15].highlighted&&"!bg-gray-100")+" svelte-red373"),this.first=n},m(i,r){ve(i,n,r),Y(n,u),Y(n,v),Y(n,b),h(),_||(g=[Xe(p=Fe.call(null,n,{position:o[15].controlled?{x:o[15].X,y:o[15].Y}:void 0,defaultPosition:o[15].controlled?void 0:{x:o[15].X,y:o[15].Y},defaultClassDragging:"dragging"})),me(n,"neodrag",o[5]),me(n,"neodrag:end",o[6])],_=!0)},p(i,r){o=i,r&4&&s!==(s=o[15].emoji+"")&&ne(u,s),r&4&&e!==(e=o[15].name+"")&&ne(b,e),r&4&&E!==(E="item absolute "+(o[15].highlighted&&"!bg-gray-100")+" svelte-red373")&&X(n,"class",E),(S!==o[16]||m!==o[17])&&(l(),S=o[16],m=o[17],h()),p&&Te(p.update)&&r&4&&p.update.call(null,{position:o[15].controlled?{x:o[15].X,y:o[15].Y}:void 0,defaultPosition:o[15].controlled?void 0:{x:o[15].X,y:o[15].Y},defaultClassDragging:"dragging"})},d(i){i&&N(n),l(),_=!1,Be(g)}}}function je(t){let o,n,s=t[12].emoji+"",u,v,e=t[12].name+"",b,E,S,m,p;function _(...g){return t[8](t[12],...g)}return{c(){o=V("div"),n=V("div"),u=ee(s),v=O(),b=ee(e),E=O(),this.h()},l(g){o=H(g,"DIV",{id:!0});var h=W(o);n=H(h,"DIV",{class:!0});var l=W(n);u=te(l,s),v=z(l),b=te(l,e),l.forEach(N),E=z(h),h.forEach(N),this.h()},h(){X(n,"class","item svelte-red373"),X(o,"id",S="item-parent-"+t[12].name.replaceAll(" ","_"))},m(g,h){ve(g,o,h),Y(o,n),Y(n,u),Y(n,v),Y(n,b),Y(o,E),m||(p=me(n,"mousedown",_),m=!0)},p(g,h){t=g,h&8&&s!==(s=t[12].emoji+"")&&ne(u,s),h&8&&e!==(e=t[12].name+"")&&ne(b,e),h&8&&S!==(S="item-parent-"+t[12].name.replaceAll(" ","_"))&&X(o,"id",S)},d(g){g&&N(o),m=!1,p()}}}function Qe(t){let o,n,s,u,v,e,b,E="Unlocked Items",S,m,p=[],_=new Map,g,h=Z(t[2]);const l=a=>a[15].id;for(let a=0;a<h.length;a+=1){let d=Re(t,h,a),f=l(d);_.set(f,p[a]=Ye(f,d))}let i=Z(t[3]),r=[];for(let a=0;a<i.length;a+=1)r[a]=je(Ae(t,i,a));return{c(){o=V("div"),n=V("div"),s=O(),u=V("div"),v=O(),e=V("div"),b=V("h2"),b.textContent=E,S=O(),m=V("div");for(let a=0;a<p.length;a+=1)p[a].c();g=O();for(let a=0;a<r.length;a+=1)r[a].c();this.h()},l(a){o=H(a,"DIV",{class:!0});var d=W(o);n=H(d,"DIV",{class:!0}),W(n).forEach(N),s=z(d),u=H(d,"DIV",{class:!0}),W(u).forEach(N),v=z(d),e=H(d,"DIV",{class:!0});var f=W(e);b=H(f,"H2",{class:!0,"data-svelte-h":!0}),Ue(b)!=="svelte-1ce9flu"&&(b.textContent=E),S=z(f),m=H(f,"DIV",{class:!0});var A=W(m);for(let D=0;D<p.length;D+=1)p[D].l(A);g=z(A);for(let D=0;D<r.length;D+=1)r[D].l(A);A.forEach(N),f.forEach(N),d.forEach(N),this.h()},h(){X(n,"class","gap-4 flex flex-wrap p-2"),X(u,"class","w-[70%]"),X(b,"class","text-4xl w-full text-center mt-4"),X(m,"class","gap-4 flex flex-wrap w-full p-2 relative"),X(e,"class","w-[30%] bg-gray-100"),X(o,"class","w-screen h-screen flex")},m(a,d){ve(a,o,d),Y(o,n),Y(o,s),Y(o,u),Y(o,v),Y(o,e),Y(e,b),Y(e,S),Y(e,m);for(let f=0;f<p.length;f+=1)p[f]&&p[f].m(m,null);Y(m,g);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(m,null);t[9](m),t[10](e)},p(a,[d]){if(d&100&&(h=Z(a[2]),p=ze(p,d,l,1,a,h,_,m,Oe,Ye,g,Re)),d&25){i=Z(a[3]);let f;for(f=0;f<i.length;f+=1){const A=Ae(a,i,f);r[f]?r[f].p(A,d):(r[f]=je(A),r[f].c(),r[f].m(m,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=i.length}},i:Ee,o:Ee,d(a){a&&N(o);for(let d=0;d<p.length;d+=1)p[d].d();We(r,a),t[9](null),t[10](null)}}}function Ze(t,o,n){let s;Ne(t,oe,l=>n(3,s=l));let u,v,e=[];const b=(l,i,r,a)=>{n(2,e=[...e,{emoji:l,name:i,id:Date.now().toString(),X:r,Y:a,controlled:!0,highlighted:!1}]),document.body.style.userSelect="none",n(2,e);let d=e.length-1,f=e[d].id;document.body.classList.add("dragging");function A(D){e[d].id!==f&&(d=e.findIndex(y=>y.id===f),d===-1)||(n(2,e[d].X=D.clientX-u.offsetLeft,e),n(2,e[d].Y=D.clientY-u.offsetTop,e),S(),n(2,e))}addEventListener("mousemove",A),addEventListener("mouseup",()=>{removeEventListener("mousemove",A),document.body.style.userSelect="",document.body.classList.remove("dragging"),!(e[d].id!==f&&(d=e.findIndex(D=>D.id===f),d===-1))&&(n(2,e[d].controlled=!1,e),m())},{once:!0})},E=()=>{for(let l=0;l<e.length;l++)if(e[l].element){for(let i=l+1;i<e.length;i++)if(e[i].element&&ke(e[l].element,e[i].element))return[l,i]}return[]},S=()=>{let l=E();for(let i=0;i<e.length;i++)n(2,e[i].highlighted=!1,e);l.length!==0&&(n(2,e[l[0]].highlighted=!0,e),n(2,e[l[1]].highlighted=!0,e)),n(2,e)},m=async()=>{var D,y;let l=[];for(let w=0;w<e.length;w++)typeof e[w].element>"u"||ke(e[w].element,v)&&l.push(e[w].id);n(2,e=e.filter(w=>!l.includes(w.id)));let i=E();if(i.length===0||e[i[0]].crafting||e[i[1]].crafting)return;n(2,e[i[0]].crafting=!0,e),n(2,e[i[1]].crafting=!0,e);let r=e[i[0]],a=e[i[1]],d=await Ke(r,a);if(!r.element||!a.element)return;let f=Math.round((((D=r.element)==null?void 0:D.getBoundingClientRect().left)+((y=a.element)==null?void 0:y.getBoundingClientRect().left))/2)-u.offsetLeft,A=Math.round((r.Y+a.Y)/2);n(2,e=e.filter(w=>w.id!==e[i[0]].id&&w.id!==e[i[1]].id)),n(2,e=[...e,{emoji:d.emoji,name:d.name,controlled:!1,highlighted:!1,id:Date.now().toString(),X:f,Y:A}]),setTimeout(()=>S(),200)};function p(l,i,r){fe[l?"unshift":"push"](()=>{i[r].element=l,n(2,e)})}const _=(l,i)=>b(l.emoji,l.name,i.clientX-u.offsetLeft,i.clientY-u.offsetTop);function g(l){fe[l?"unshift":"push"](()=>{u=l,n(0,u)})}function h(l){fe[l?"unshift":"push"](()=>{v=l,n(1,v)})}return[u,v,e,s,b,S,m,p,_,g,h]}class nt extends Ve{constructor(o){super(),He(this,o,Ze,Qe,Me,{})}}export{nt as component};
